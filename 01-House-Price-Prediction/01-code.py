import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import numpy as np
x= np.array([[50, 1, 10, 0], [55, 1, 5, 0], [60, 1, 2, 0], [65, 2, 12, 0], [70, 2, 8, 0], 
    [75, 2, 1, 0], [80, 2, 15, 0], [85, 2, 4, 0], [90, 2, 6, 0], [95, 2, 2, 0],
    [100, 2, 10, 0], [105, 3, 5, 1], [110, 3, 3, 0], [115, 3, 1, 1], [120, 3, 8, 0], 
    [125, 3, 4, 1], [130, 3, 12, 0], [135, 3, 2, 1], [140, 3, 6, 0], [145, 3, 1, 1],
    [150, 3, 9, 1], [155, 4, 5, 0], [160, 4, 2, 1], [165, 4, 10, 0], [170, 4, 3, 1], 
    [175, 4, 1, 1], [180, 4, 7, 1], [185, 4, 4, 1], [190, 4, 12, 0], [195, 4, 2, 1],
    [200, 4, 5, 1], [210, 5, 8, 1], [220, 5, 3, 1], [230, 5, 1, 1], [240, 5, 10, 1], 
    [250, 5, 4, 1], [260, 5, 2, 1], [270, 5, 6, 1], [280, 5, 1, 1], [290, 5, 3, 1],
    [300, 6, 5, 1], [310, 6, 2, 1], [320, 6, 8, 1], [330, 6, 1, 1], [340, 6, 4, 1], 
    [350, 7, 2, 1], [360, 7, 5, 1], [370, 7, 1, 1], [380, 8, 3, 1], [400, 8, 1, 1]])

y = np.array([450, 480, 510, 580, 620, 650, 700, 730, 780, 820,
    850, 950, 990, 1030, 1050, 1100, 1150, 1200, 1240, 1280,
    1320, 1420, 1470, 1510, 1550, 1600, 1650, 1700, 1750, 1800,
    1850, 1950, 2050, 2150, 2250, 2350, 2450, 2550, 2650, 2750,
    2900, 3050, 3200, 3350, 3500, 3700, 3850, 4000, 4200, 4500])


model = Sequential([Dense(units=16, activation='relu', input_shape=(4,)),
                    Dense(units=8, activation='relu'),
                   Dense(units=1)])



model.compile(optimizer='adam',
              loss='mse',)
model.fit(x,y , epochs=1000)
x_new = np.array([[275.0,10.0,5,1]])
predict = model.predict(x_new)

print(f"the result :{predict[0][0]:.2f} K")
model.save('first_pr')
